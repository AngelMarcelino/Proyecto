<?php

include ("sidebar-admin.html");
include ("getCategories.php");
?>
    <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
        <h2 class="placeholder">Categorias</h2>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Nombre</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <?php
                    for($u = 0; $u < count($categorias); $u++)
                    {
                        $categoria = $categorias[$u];
                        echo '<tr>'.
                        '<td>'.$categoria["Nombre"] . '</td>'.
                        '<td><a class="btn btn-default" href="'.urlParams("Categories/editarCategoria.php", array("categoria" => $categoria["Id"]))
                        .
                        '"><span class="glyphicon glyphicon-pencil"></span></a>'.
                        '<a class="btn btn-danger" onclick="deleteCategory(event)" data-categoria="'. $categoria['Id']. '"><span class="glyphicon glyphicon-trash"></a></tr>'.

                        '<tr>';
                    }
                    
                ?>
            </tbody>
        </table>
            <a href="index.php?pagina=Categories/agregarCategoria.php"class="btn btn-primary btn-lg">Agregar nueva</a>
        
        <script>

                function deleteCategory(event)
                {
                    var Id  = event.srcElement.dataset["categoria"];
                    console.log(event.srcElement);
                    if(confirm("Seguro que deseas eliminar")){
                        window.location =getUrl() + "/administradores/Categories/deleteCategory.php?categoria=" + Id;
                    }
                }

                $("#search").on("keyup", function(e)
                {
                    var tds = $("td:first-child");
                    console.log(tds);
                    tds.each(function(i)
                    {
                        if(e.target.value == "")
                        {
                            $(this).parent().fadeIn();
                        }
                        else{
                            if($(this).html().toLowerCase().includes(e.target.value.toLowerCase()))
                            {
                                $(this).parent().fadeIn();
                            }
                            else
                            {
                                $(this).parent().fadeOut();
                                
                            } 
                        }
                        
                    });
                    
                }).prop("disabled", false);
            
        </script>
    </div>